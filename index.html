<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片预览</title>
    <style>
        /* 基础样式重置 - 完全匹配图片尺寸 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            background-color: #ffffff;
            overflow-x: hidden;
        }
        
        /* 禁用文字选择 */
        body {
            -webkit-touch-callout: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            -webkit-tap-highlight-color: transparent;
            cursor: default;
            /* 设置初始尺寸，图片加载后会调整 */
            min-height: 100vh;
        }
        
        /* 图片容器 - 精确匹配图片尺寸，无额外留白 */
        .image-container {
            display: block;
            width: 100%;
            background-color: #ffffff;
            /* 去掉padding和margin，避免额外空间 */
            padding: 0;
            margin: 0;
        }
        
        /* 图片样式 - 保持原始质量和尺寸，完全自适应 */
        .protected-image {
            display: block;
            width: 100%;
            height: auto;
            pointer-events: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            /* 确保图片完全显示，不留白边 */
            max-width: 100%;
            max-height: none;
        }
        
        /* 透明保护层覆盖整个页面 */
        .protection-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            cursor: default;
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <!-- 图片容器 - 精确匹配图片尺寸 -->
    <div class="image-container">
        <!-- 保护性图片显示 -->
        <img src="nijiukanwoniubuniubijiuwanle.png" 
             alt="受保护的图片内容" 
             class="protected-image" 
             id="protectedImage">
    </div>
    
    <!-- 透明保护层，防止直接与图片交互 -->
    <div class="protection-overlay" id="protectionOverlay"></div>

    <script>
        // 获取元素
        const protectedImage = document.getElementById('protectedImage');
        const protectionOverlay = document.getElementById('protectionOverlay');
        
        // 禁用右键菜单
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 禁用拖拽
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 禁用选择
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 禁用键盘快捷键
        document.addEventListener('keydown', function(e) {
            // 禁用Print Screen键
            if (e.keyCode === 44) {
                e.preventDefault();
                return false;
            }
            
            // 禁用Ctrl+P (打印)
            if (e.ctrlKey && e.keyCode === 80) {
                e.preventDefault();
                return false;
            }
            
            // 禁用Ctrl+S (保存)
            if (e.ctrlKey && e.keyCode === 83) {
                e.preventDefault();
                return false;
            }
            
            // 禁用F12 (开发者工具)
            if (e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
        });
        
        // 图片加载完成后，精确调整页面尺寸与图片一致
        protectedImage.onload = function() {
            // 获取图片原始尺寸
            const naturalWidth = this.naturalWidth;
            const naturalHeight = this.naturalHeight;
            
            // 移除所有可能导致留白的样式
            const container = document.querySelector('.image-container');
            const body = document.body;
            const html = document.documentElement;
            
            // 计算图片在100%宽度下的实际显示高度
            const viewportWidth = window.innerWidth;
            const scaleFactor = viewportWidth / naturalWidth;
            const displayHeight = naturalHeight * scaleFactor;
            
            // 设置body和html高度精确匹配图片显示高度
            body.style.height = displayHeight + 'px';
            html.style.height = displayHeight + 'px';
            
            // 设置容器高度精确匹配图片显示高度
            container.style.height = displayHeight + 'px';
            
            console.log('图片已加载，原始尺寸:', naturalWidth + 'x' + naturalHeight + '像素');
            console.log('显示尺寸:', viewportWidth + 'x' + displayHeight + '像素');
            console.log('页面尺寸已精确匹配图片显示尺寸');
            
            // 如果有轻微误差，确保图片占满容器
            const imgElement = document.querySelector('.protected-image');
            imgElement.style.width = '100%';
            imgElement.style.height = '100%';
            imgElement.style.objectFit = 'contain';
        };
        
        // 如果图片已经缓存，直接触发加载事件
        if (protectedImage.complete) {
            protectedImage.onload();
        }
        
        // 图片加载失败处理
        protectedImage.onerror = function() {
            console.error('图片加载失败，请检查图片路径或文件名');
            console.log('当前图片路径:', this.src);
            
            // 尝试常见的图片扩展名
            const baseName = this.src.split('.')[0];
            const extensions = ['.png', '.jpg', '.jpeg', '.gif', '.webp', '.PNG', '.JPG'];
            
            let found = false;
            for (let ext of extensions) {
                const testSrc = baseName + ext;
                const testImage = new Image();
                testImage.onload = function() {
                    if (!found) {
                        protectedImage.src = testSrc;
                        console.log('找到图片:', testSrc);
                        found = true;
                    }
                };
                testImage.src = testSrc;
            }
        };
        
        // 防止通过检查元素获取图片
        (function() {
            // 监控DOM变化
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.removedNodes) {
                        mutation.removedNodes.forEach(function(node) {
                            if (node === protectedImage) {
                                document.querySelector('.image-container').appendChild(protectedImage);
                                console.log('检测到图片被移除，已恢复');
                            }
                        });
                    }
                });
            });
            
            observer.observe(document.body, { childList: true, subtree: true });
        })();
        
        // 窗口大小变化时重新计算尺寸
        window.addEventListener('resize', function() {
            if (protectedImage.complete) {
                // 重新计算图片显示尺寸
                const naturalWidth = protectedImage.naturalWidth;
                const naturalHeight = protectedImage.naturalHeight;
                const viewportWidth = window.innerWidth;
                const scaleFactor = viewportWidth / naturalWidth;
                const displayHeight = naturalHeight * scaleFactor;
                
                // 重新设置高度
                document.body.style.height = displayHeight + 'px';
                document.documentElement.style.height = displayHeight + 'px';
                document.querySelector('.image-container').style.height = displayHeight + 'px';
                
                console.log('窗口大小改变，重新计算显示尺寸:', viewportWidth + 'x' + displayHeight + '像素');
            }
        });
        
        // 初始加载后检查一次，确保没有留白
        setTimeout(function() {
            if (protectedImage.complete) {
                // 检查图片是否占满容器
                const container = document.querySelector('.image-container');
                const img = document.querySelector('.protected-image');
                
                if (container.offsetHeight > img.offsetHeight) {
                    // 如果有留白，调整容器高度与图片一致
                    container.style.height = img.offsetHeight + 'px';
                    document.body.style.height = img.offsetHeight + 'px';
                    document.documentElement.style.height = img.offsetHeight + 'px';
                    console.log('检测到留白，已调整容器高度');
                }
            }
        }, 500);
    </script>
</body>
</html>
